基本代碼規範
=====================

本篇規範制定了代碼基本元素的相關標準，
以確保共享的PHP代碼間具有較高程度的技術互通性。

關鍵詞 「必須」("MUST")、「一定不可/一定不能」("MUST NOT")、「需要」("REQUIRED")、
「將會」("SHALL")、「不會」("SHALL NOT")、「應該」("SHOULD")、「不該」("SHOULD NOT")、
「推薦」("RECOMMENDED")、「可以」("MAY")和」可選「("OPTIONAL")的詳細描述可參見 [RFC 2119][] 。

[RFC 2119]: http://www.ietf.org/rfc/rfc2119.txt
[PSR-0]: https://github.com/PizzaLiu/PHP-FIG/blob/master/PSR-0-cn.md
[PSR-4]: https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-4-autoloader.md


1. 概覽
-----------

- PHP代碼檔案**必須**以 `<?php` 或 `<?=` 標籤開始；

- PHP代碼檔案**必須**以 `不帶BOM的 UTF-8` 編碼；

- PHP代碼中**應該**只定義類、函數、常量等聲明，或其他會產生 `從屬效應` 的操作（如：建立檔案輸出以及修改.ini配置檔案等），二者只能選其一；

- 命名空間以及類**必須**符合 PSR 的自動加載規範：[PSR-4][]；

- 類的命名**必須**遵循 `StudlyCaps` 大寫開頭的駝峰命名規範；

- 類中的常量所有字母都**必須**大寫，單詞間用下劃線分隔；

- 方法名稱**必須**符合 `camelCase` 式的小寫開頭駝峰命名規範。


2. 檔案
--------

### 2.1. PHP標籤

PHP代碼**必須**使用 `<?php ?>` 長標籤 或 `<?= ?>` 短輸出標籤；
**一定不可**使用其它自訂標籤。

### 2.2. 字符編碼

PHP代碼**必須**且只可使用`不帶BOM的UTF-8`編碼。

### 2.3. 從屬效應（副作用）

一份PHP檔案中**應該**要不就只定義新的聲明，如類、函數或常量等不產生從屬效應的操作，要不就只有會產生從屬效應的邏輯操作，但**不該**同時具有兩者。

「從屬效應」(side effects)一詞的意思是，僅僅通過包含檔案，不直接聲明類、
函數和常量等，而執行的邏輯操作。

「從屬效應」包含卻不僅限於：建立輸出、直接的 `require` 或 `include`、連接外部服務、修改 ini 配置、拋出錯誤或異常、修改全局或靜態變量、讀或寫檔案等。

以下是一個錯誤的例子，一份包含聲明以及產生從屬效應的代碼：

```php
<?php
// 從屬效應：修改 ini 配置
ini_set('error_reporting', E_ALL);

// 從屬效應：引入檔案
include "file.php";

// 從屬效應：建立輸出
echo "<html>\n";

// 聲明函數
function foo()
{
    // 函數主體部分
}
```

下面是一個範例，一份只包含聲明不產生從屬效應的代碼：

```php
<?php
// 聲明函數
function foo()
{
    // 函數主體部分
}

// 條件聲明**不**屬於從屬效應
if (! function_exists('bar')) {
    function bar()
    {
        // 函數主體部分
    }
}
```


3. 命名空間和類
----------------------------

命名空間以及類的命名必須遵循 [PSR-4][]。

根據規範，每個類都獨立為一個檔案，且命名空間至少有一個層次：頂級的組織名稱（vendor name）。

類的命名必須 遵循 `StudlyCaps` 大寫開頭的駝峰命名規範。

PHP 5.3及以後版本的代碼**必須**使用正式的命名空間。

例如：

```php
<?php
// PHP 5.3及以後版本的寫法
namespace Vendor\Model;

class Foo
{
}
```

5.2.x及之前的版本**應該**使用偽命名空間的寫法，約定俗成使用頂級的組織名稱（vendor name）如 `Vendor_` 為類前綴。

```php
<?php
// 5.2.x及之前版本的寫法
class Vendor_Model_Foo
{
}
```

4. 類的常量、屬性和方法
-------------------------------------------

此處的「類」指代所有的類、接口以及可復用代碼塊（traits）

### 4.1. 常量

類的常量中所有字母都**必須**大寫，詞間以下劃線分隔。
參照以下代碼：

```php
<?php
namespace Vendor\Model;

class Foo
{
    const VERSION = '1.0';
    const DATE_APPROVED = '2012-06-01';
}
```

### 4.2. 屬性

類的屬性命名可以遵循 大寫開頭的駝峰式 (`$StudlyCaps`)、小寫開頭的駝峰式 (`$camelCase`) 又或者是 下劃線分隔式 (`$under_score`)，本規範不做強制要求，但無論遵循哪種命名方式，都**應該**在一定的範圍內保持一致。這個範圍可以是整個團隊、整個包、整個類或整個方法。

### 4.3. 方法

方法名稱**必須**符合 `camelCase()` 式的小寫開頭駝峰命名規範。
